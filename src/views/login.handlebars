{{#section "styles"}}
  <link rel="stylesheet" href="/css/login.css" />
{{/section}}

{{#section "scripts"}}
  <script type="module" src="/js/login.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('login-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      
      try {
        const response = await fetch('/api/auth/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, password }),
          credentials: 'include' // Important: allow cookies to be set
        });
        
        if (!response.ok) {
          alert('Login failed. Please check your credentials.');
          return;
        }
        
        // No need to set cookies manually, it's handled by the server with httpOnly cookies
        alert('Login successful!');
        window.location.href = '/items';
      } catch (error) {
        alert('Login error: ' + error);
      }
    });
  });
</script>
{{/section}}

<div class="login-container">
  <h1>Login</h1>
  <form id="login-form">
    <div class="form-group">
      <label for="email" class="form-label">email:</label>
      <input type="email" id="email" name="email" required class="username-input" />
    </div>
    <div class="form-group">
      <label for="password" class="form-label">Password:</label>
      <input type="password" id="password" name="password" required class="password-input" />
    </div>
    <button type="submit" class="login-button">Login</button>
  </form>
</div>